(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4865fd71"],{"28a5":function(e,t,i){"use strict";var a=i("aae3"),n=i("cb7c"),l=i("ebd6"),o=i("0390"),r=i("9def"),s=i("5f1b"),u=i("520a"),c=i("79e5"),d=Math.min,m=[].push,f="split",h="length",g="lastIndex",p=4294967295,b=!c(function(){RegExp(p,"y")});i("214f")("split",2,function(e,t,i,c){var y;return y="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[h]||2!="ab"[f](/(?:ab)*/)[h]||4!="."[f](/(.?)(.?)/)[h]||"."[f](/()()/)[h]>1||""[f](/.?/)[h]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!a(e))return i.call(n,e,t);var l,o,r,s=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?p:t>>>0,b=new RegExp(e.source,c+"g");while(l=u.call(b,n)){if(o=b[g],o>d&&(s.push(n.slice(d,l.index)),l[h]>1&&l.index<n[h]&&m.apply(s,l.slice(1)),r=l[0][h],d=o,s[h]>=f))break;b[g]===l.index&&b[g]++}return d===n[h]?!r&&b.test("")||s.push(""):s.push(n.slice(d)),s[h]>f?s.slice(0,f):s}:"0"[f](void 0,0)[h]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,a){var n=e(this),l=void 0==i?void 0:i[t];return void 0!==l?l.call(i,n,a):y.call(String(n),i,a)},function(e,t){var a=c(y,e,this,t,y!==i);if(a.done)return a.value;var u=n(e),m=String(this),f=l(u,RegExp),h=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(b?"y":"g"),F=new f(b?u:"^(?:"+u.source+")",g),D=void 0===t?p:t>>>0;if(0===D)return[];if(0===m.length)return null===s(F,m)?[m]:[];var v=0,x=0,S=[];while(x<m.length){F.lastIndex=b?x:0;var C,N=s(F,b?m:m.slice(x));if(null===N||(C=d(r(F.lastIndex+(b?0:x)),m.length))===v)x=o(m,x,h);else{if(S.push(m.slice(v,x)),S.length===D)return S;for(var R=1;R<=N.length-1;R++)if(S.push(N[R]),S.length===D)return S;x=v=C}}return S.push(m.slice(v)),S}]})},"2b53":function(e,t,i){"use strict";i("c5f6");var a=i("0f1a");t["a"]={getRoleList:function(e){return a["a"].get("/Role/Get",{params:e})},addRole:function(e){return a["a"].post("/Role/Post",{cRoleName:e.cRoleName,isSuperAdmin:e.isSuperAdmin})},editRole:function(e){return a["a"].put("/Role/Put?iRoleID="+Number(e.iRoleID),e)},delRole:function(e){return a["a"].delete("/Role/Delete",{params:{iRoleID:Number(e)}})}}},74453:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table_style"},[i("el-row",{staticClass:"modularWrapper",attrs:{type:"flex"}},[i("el-col",{staticClass:"table-flex-wraper"},[i("el-form",{attrs:{"label-width":"50px"}},[i("el-row",[i("el-col",{attrs:{span:"6",lg:4}},[i("el-form-item",{attrs:{label:"岗位：",prop:"FormcRoleName"}},[i("el-input",{attrs:{placeholder:"请输入岗位名称"},model:{value:e.FormcRoleName,callback:function(t){e.FormcRoleName=t},expression:"FormcRoleName"}})],1)],1),i("el-col",{attrs:{span:"4"}},[i("div",{staticStyle:{padding:"0","padding-left":"20px"},attrs:{type:"flex",justify:"start"}},[e.$options.filters.btnTree("/api/Role/Get",e.$route.meta.iFunID)?i("el-button",{staticClass:"my-search",attrs:{size:"mini"},on:{click:e.getRoleList}},[e._v("查询")]):e._e()],1)])],1)],1),i("div",{staticClass:"table-btn-control"},[i("el-row",{attrs:{type:"flex",justify:"strat"}},[e.$options.filters.btnTree("/api/Role/Post",e.$route.meta.iFunID)?i("el-button",{staticClass:"my-tableout",attrs:{plain:"",size:"mini"},on:{click:e.addRole}},[i("i",{staticClass:"iconfont icon-xinzeng"}),e._v("新增\n          ")]):e._e(),e.$options.filters.btnTree("/api/Role/Put",e.$route.meta.iFunID)?i("el-button",{staticClass:"my-tableout",attrs:{size:"mini"},on:{click:e.editRole}},[i("i",{staticClass:"iconfont icon-bianji"}),e._v("编辑\n          ")]):e._e(),e.$options.filters.btnTree("/api/Role/Delete",e.$route.meta.iFunID)?i("el-button",{staticClass:"my-tableout",attrs:{size:"mini"},on:{click:e.delRole}},[i("i",{staticClass:"iconfont icon-shanchu"}),e._v("删除\n          ")]):e._e()],1)],1),i("SysTable",{attrs:{tableData:e.tableData,loading:e.loading,layerListName:"RoleManage_Columns",paginationShow:!1,modularDialog:!0},on:{currentChange:e.currentChange,modularDialogOpen:e.modularDialogOpen}})],1)],1),i("el-dialog",{staticClass:"myDialog",attrs:{title:e.dialogtype?"编辑岗位":"新增岗位",visible:e.dialogVisible,width:"300","before-close":e.handleClose,customClass:"el_add_dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"formDialog",attrs:{"label-width":"100px",size:"small",rules:e.rules,model:e.formValue}},[i("el-form-item",{attrs:{label:"岗位名称：",prop:"cRoleName"}},[i("el-input",{attrs:{placeholder:"请输入岗位名称"},model:{value:e.formValue.cRoleName,callback:function(t){e.$set(e.formValue,"cRoleName",t)},expression:"formValue.cRoleName"}})],1),i("el-form-item",{attrs:{label:"超级管理员：",prop:"cRoleName"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.formValue.isSuperAdmin,callback:function(t){e.$set(e.formValue,"isSuperAdmin",t)},expression:"formValue.isSuperAdmin"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"my-dialog-cancel",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{staticClass:"my-dialog-submit",attrs:{loading:e.sunBtnLoad},on:{click:e.editFormSubmit}},[e._v("确 定")])],1)],1),i("modularDialog",{attrs:{modularDialogVisable:e.modularDialogVisable,nodeID:e.dialognodeID,modulaBtnVisable:e.modulaBtnVisable},on:{"update:modularDialogVisable":function(t){e.modularDialogVisable=t},modularDialogSubmit:e.modularDialogSubmit,"update:modulaBtnVisable":function(t){e.modulaBtnVisable=t}}})],1)},n=[],l=(i("99db"),i("2b53")),o=i("78cd"),r=i("fbc2"),s=i("ccc3"),u=i("f478"),c={components:{modularDialog:u["a"],SysTable:s["a"]},data:function(){return{rules:{cRoleName:[{required:!0,message:"请输入岗位名称",trigger:"blur"}]},modularList:[],defaultProps:{children:"children",label:"cFunName"},FatherList:[],tableData:[],currentRow:null,nodeID:-1,System_Type:1,dialogVisible:!1,dialogtype:0,FormcRoleName:"",formValue:{cRoleName:"",isSuperAdmin:!1},modularDialogVisable:!1,dialognodeID:[],loading:!0,sunBtnLoad:!1,modulaBtnVisable:!1}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;this.loading=!0,l["a"].getRoleList({roleName:String(this.FormcRoleName)}).then(function(t){e.loading=!1,e.tableData=t.data.Data.Result,e.$store.dispatch("system/setState",{name:"roleList",value:t.data.Data.Result})})},currentChange:function(e){this.currentRow=e},delRole:function(){var e=this;this.currentRow?this.$confirm("确定删除么").then(function(){e.loading=!0,l["a"].delRole(e.currentRow.iRoleID).then(function(){e.loading=!0,e.$message({type:"success",message:"成功删除数据",showClose:!0}),e.getRoleList()}).catch(function(){e.$message({type:"error",message:"删除数据失败",showClose:!0})})}).catch(function(){e.$message({type:"warning",message:"取消删除数据",showClose:!0})}):this.$message({type:"warning",message:"请选择需要删除的数据",showClose:!0})},editRole:function(){this.currentRow?(this.formValue=_.assign({},this.currentRow),this.dialogVisible=!0,this.dialogtype=1):this.$message({type:"warning",message:"请选择需要编辑的数据",showClose:!0})},addRole:function(){this.dialogVisible=!0,this.dialogtype=0,this.formValue={cRoleName:"",isSuperAdmin:!1}},editFormSubmit:function(){var e=this;this.$refs.formDialog.validate(function(t){if(!t)return!1;e.sunBtnLoad=!0,e.dialogtype?l["a"].editRole(e.formValue).then(function(t){e.dialogVisible=!1,e.sunBtnLoad=!1,e.$message({type:"success",message:"新增用户成功",showClose:!0}),e.getRoleList()}).catch(function(t){e.sunBtnLoad=!1}):l["a"].addRole(e.formValue).then(function(t){e.sunBtnLoad=!1,e.dialogVisible=!1,e.$message({type:"success",message:"编辑用户成功",showClose:!0}),e.getRoleList()}).catch(function(t){e.sunBtnLoad=!1})})},handleClose:function(e){e()},modularDialogOpen:function(e){var t=this;this.loading=!0,o["a"].getRoleAuthority(e.iRoleID).then(function(e){var i=e.data.Data.Result;t.dialognodeID=_.map(i,"iFunID"),t.modularDialogVisable=!0,t.modulaBtnVisable=!1,t.loading=!1})},modularDialogSubmit:function(e){var t=this;if(!e.length)return this.$message({type:"error",message:"权限不能为空",showClose:!0}),void(this.modulaBtnVisable=!1);var i={iPurviewID:this.currentRow.iRoleID,iPurviewType:2,functionIds:e};r["a"].editAuthority(i).then(function(e){t.modulaBtnVisable=!1,t.modularDialogVisable=!1,t.getRoleList()}).catch(function(){t.modulaBtnVisable=!1})}}},d=c,m=i("2877"),f=Object(m["a"])(d,a,n,!1,null,null,null);f.options.__file="RoleManage.vue";var h=f.exports;t["default"]=h},"99db":function(e,t,i){"use strict";i("c5f6");var a=i("0f1a");t["a"]={getModular:function(){return a["a"].get("/Function/Get")},delModular:function(e){return a["a"].delete("/Function/Delete",{params:{iFunId:Number(e)}})},addModular:function(e){return a["a"].post("/Function/Post",{System_Type:Number(e.System_Type),FunctionType:Number(e.FunctionType),cFunName:e.cFunName,cFunUrl:e.cFunUrl,iFunFatherID:Number(e.iFunFatherID),iFunMenuIsShow:Number(e.iFunMenuIsShow),iFunOrder:Number(e.iFunOrder),cFunIcon:e.cFunIcon})},editModular:function(e){return a["a"].put("/Function/Put",{iFunID:Number(e.iFunID),System_Type:Number(e.System_Type),FunctionType:Number(e.FunctionType),cFunName:e.cFunName,cFunUrl:e.cFunUrl,iFunFatherID:Number(e.iFunFatherID),iFunMenuIsShow:Number(e.iFunMenuIsShow),iFunOrder:Number(e.iFunOrder),cFunIcon:e.cFunIcon})}}},ccc3:function(e,t,i){"use strict";var a={};i.r(a),i.d(a,"DeptManage_Columns",function(){return o}),i.d(a,"UserManage_Columns",function(){return r}),i.d(a,"Modular_Columns",function(){return u}),i.d(a,"RoleManage_Columns",function(){return c}),i.d(a,"AppUpload_Columns",function(){return d});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table-contain-wrapper"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"outDataSerchExcel exportTable",attrs:{stripe:"",border:"",height:"100%",data:e.tableData,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[e._l(e.columnList,function(t){return[t.template?i("el-table-column",{key:t.text,attrs:{fit:"true",prop:t.field,label:t.text,width:t.width,align:t.align,sortable:t.sortable,formatter:t.formatter},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[i("span",{domProps:{innerHTML:e._s(t.template(n))}})]}}])}):i("el-table-column",{key:t.text,attrs:{fit:"true",prop:t.field,label:t.text,width:t.width,align:t.align,sortable:t.sortable,formatter:t.formatter}})]}),e.$options.filters.btnTree("/api/FunPurview/RefreshFunPurview",e.$route.meta.iFunID)&&e.modularDialog?i("el-table-column",{attrs:{prop:"iRoleID",label:"功能权限",align:"center",fixed:"right",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("span",{staticClass:"my-detail",on:{click:function(t){e.modularDialogOpen(a)}}},[e._v("功能权限")])]}}])}):e._e()],2),e.paginationShow?i("el-pagination",{attrs:{"current-page":e.pageNumber,"page-size":e.pageSize,"page-sizes":[1,50,100,200],"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:e.dataTotal},on:{"size-change":e.onPageSizeChange,"current-change":e.onPageChange,"update:currentPage":function(t){e.pageNumber=t}}}):e._e()],1)},l=[],o=[{field:"cDepName",text:"部门名称",align:"center",fixed:!1},{field:"cDepTel",text:"电话",align:"center",fixed:!1},{field:"cDepEmail",text:"邮件",align:"center",fixed:!1}],r=[{field:"cAdminName",text:"姓名",align:"center",fixed:!1},{field:"CJobNumber",text:"工号",align:"center",fixed:!1},{field:"cDepName",text:"部门",align:"center",fixed:!1},{field:"cRoleName",text:"岗位",align:"center",fixed:!1},{field:"cAdminSex",text:"性别",align:"center",fixed:!1},{field:"cAdminTel",text:"电话",align:"center",fixed:!1},{field:"cAdminEmail",text:"邮件",align:"center",fixed:!1},{field:"iIsLocked",text:"是否锁定",formatter:function(e,t,i,a){return i?"是":"否"},align:"center",fixed:!1},{field:"dExpireDate",text:"过期日期",align:"center",fixed:!1},{field:"iIsAllowChangePWD",text:"密码修改",formatter:function(e,t,i,a){return i?"允许":"不允许"},align:"center",fixed:!1}],s={1:"B/S 显示",3:"手机app",4:"C/S 显示"},u=[{field:"iFunID",text:"ID",align:"center",fixed:!1},{field:"cFunName",text:"功能名称",align:"center",fixed:!1},{field:"cFunUrl",text:"功能URl",align:"center",fixed:!1},{field:"cFunIcon",text:"icon名称",align:"center",fixed:!1},{field:"iFunOrder",text:"排序",align:"center",fixed:!1,sortable:!0},{field:"iFunMenuIsShow",text:"是否显示",template:function(e){return"<span class='"+(e.iFunMenuIsShow?"my-show-span":"")+"'>"+(e.iFunMenuIsShow?"显示":"隐藏")+"</span>"},align:"center",fixed:!1},{field:"System_Type",text:"系统类型",formatter:function(e,t,i,a){return s[i]},align:"center",fixed:!1},{field:"FunctionType",text:"点击类型",formatter:function(e,t,i,a){return 1===i?"页面":"按钮"},align:"center",fixed:!1}],c=[{field:"cRoleName",text:"岗位名称",align:"center",fixed:!1},{field:"isSuperAdmin",text:"是否是超级管理员",formatter:function(e,t,i,a){return i?"是":"否"},align:"center",fixed:!1}],d=[{field:"APKNAME",text:"APK名称",align:"center",fixed:!1},{field:"VERSIONID",text:"版本号",align:"center",fixed:!1},{field:"UPLOADTIME",text:"上传时间",align:"center",fixed:!1}],m={props:["tableData","layerListName","loading","dataTotal","pageNumber","pageSize","paginationShow","modularDialog"],data:function(){return{}},computed:{columnList:function(){return a[this.layerListName]}},methods:{handleCurrentChange:function(e){this.$emit("currentChange",e)},onPageChange:function(e){this.$emit("onPageChange",e)},onPageSizeChange:function(e){this.$emit("onPageSizeChange",e)},modularDialogOpen:function(e){this.$emit("modularDialogOpen",e)}}},f=m,h=i("2877"),g=Object(h["a"])(f,n,l,!1,null,null,null);g.options.__file="SysTable.vue";t["a"]=g.exports},f478:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"myDialog modularDialog",attrs:{title:"模块选择",visible:e.modularDialogVisable,width:"300","before-close":e.handleClose,customClass:"el_add_dialog"},on:{"update:visible":function(t){e.modularDialogVisable=t}}},[i("el-scrollbar",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"400px"}},[i("el-tree",{ref:"tree",attrs:{"highlight-current":"",data:e.modularList,props:e.defaultProps,"default-expanded-keys":[-1],"default-checked-keys":e.treeNeedNodeID,"node-key":"iFunID","show-checkbox":""}})],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"my-dialog-cancel",attrs:{loading:e.modulaBtnVisable},on:{click:e.modularFormSubmit}},[e._v("修 改")]),i("el-button",{staticClass:"my-dialog-submit",on:{click:e.modularFormClose}},[e._v("关 闭")])],1)],1)},n=[],l=(i("28a5"),i("c5f6"),i("ac6a"),i("99db")),o={props:["modularDialogVisable","nodeID","modulaBtnVisable"],data:function(){return{loading:!0,modularList:[],defaultProps:{children:"children",label:"cFunName"},FatherList:[],treeList:[],treeNeedNodeID:[],System_Type:1,typeList:{0:"手机app",1:"B/S 显示",4:"C/S 显示"},typeListArr:[{name:"手机app",value:0},{name:"B/S 显示",value:1},{name:"C/S 显示",value:4}],CheckedAllNodes:[]}},watch:{nodeID:function(){for(var e=_.cloneDeep(this.nodeID),t=0;t<e.length;t++)if(this.treeList[e[t]]){var i=this.treeList[e[t]].length;if(i){for(var a=0;a<e.length;a++)_.indexOf(this.treeList[e[t]],e[a])>-1&&i--;i&&(e.splice(t,1),t--)}}this.treeNeedNodeID=e,this.$refs.tree&&this.$refs.tree.setCheckedNodes(this.nodeID)}},created:function(){this.getModularList()},methods:{getModularList:function(){var e=this;this.$store.state.system.modular.length?(this.modularList=this.$store.state.system.modular,this.loading=!1):(this.loading=!0,l["a"].getModular().then(function(t){e.FatherList={},e.treeList={};var i=t.data.Data.Result;_.forEach(i,function(t){e.FatherList[t.System_Type]||(e.FatherList[t.System_Type]={iFunID:"0#"+t.System_Type},e.FatherList[t.System_Type].cFunName=e.typeList[t.System_Type],e.FatherList[t.System_Type],e.FatherList[t.System_Type].System_Type=t.System_Type),e.FatherList[t.System_Type][t.iFunFatherID]?e.FatherList[t.System_Type][t.iFunFatherID].push(t):e.FatherList[t.System_Type][t.iFunFatherID]=[t],e.treeList[t.iFunFatherID]?e.treeList[t.iFunFatherID].push(t):e.treeList[t.iFunFatherID]=[t]});var a=_.cloneDeep(e.FatherList);e.modularList=[{iFunID:-1,cFunName:"智慧水务管理系统",children:[]}],_.forEach(a,function(t,i){e.ModularSerialize([t],t.System_Type),e.modularList[0].children.push(t)}),e.$store.dispatch("system/setState",{name:"modular",value:e.modularList}),e.loading=!1}))},ModularSerialize:function(e,t){var i=this;_.map(e,function(e){var a=_.isString(e.iFunID)?Number(e.iFunID.split("#")[0]):e.iFunID;if(i.FatherList[t][a]){e.children=i.FatherList[t][a];var n={};n.iFunID=a,e.parent&&(n.parent=e.parent),_.forEach(e.children,function(e){e.parent=n}),i.ModularSerialize(i.FatherList[t][a],t)}})},handleClose:function(e){this.$emit("update:modularDialogVisable",!1),e()},modularFormClose:function(){this.$emit("update:modularDialogVisable",!1)},nodeparent:function(e){e.parent&&(this.CheckedAllNodes.push(e.iFunID),this.nodeparent(e.parent))},modularFormSubmit:function(){var e=this;this.$emit("update:modulaBtnVisable",!0);var t=this.$refs.tree.getCheckedNodes();this.CheckedAllNodes=[],_.forEach(t,function(t){e.CheckedAllNodes.push(t.iFunID),e.nodeparent(t)}),this.CheckedAllNodes=_.union(this.CheckedAllNodes),this.CheckedAllNodes=_.filter(this.CheckedAllNodes,function(e){return!_.isString(e)}),this.$emit("modularDialogSubmit",this.CheckedAllNodes)}}},r=o,s=i("2877"),u=Object(s["a"])(r,a,n,!1,null,null,null);u.options.__file="modularDialog.vue";t["a"]=u.exports},fbc2:function(e,t,i){"use strict";i("c5f6");var a=i("0f1a");t["a"]={editAuthority:function(e){return Object(a["a"])({method:"post",url:"/FunPurview/RefreshFunPurview",params:{iPurviewType:Number(e.iPurviewType),iPurviewID:Number(e.iPurviewID)},data:e.functionIds})}}}}]);
//# sourceMappingURL=chunk-4865fd71.0ef2ccc2.js.map