(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-124bf5a4"],{1520:function(e,a,t){"use strict";t("c5f6");var n=t("d255");a["a"]={DeptData:function(){return n["a"].get("/Department/GetUserComboboxList")},AdminNameData:function(e){return n["a"].get("/User/GetUserComboboxList",{params:{deptId:Number(e)}})},GetUserComboboxListNoDelete:function(e){return n["a"].get("/User/GetUserComboboxListNoDelete",{params:{deptId:Number(e)}})},GetPlanCycle:function(){return n["a"].get("/PlanCycle/GetCombobox")}}},"28a5":function(e,a,t){"use strict";var n=t("aae3"),i=t("cb7c"),l=t("ebd6"),s=t("0390"),r=t("9def"),o=t("5f1b"),m=t("520a"),u=t("79e5"),c=Math.min,f=[].push,p="split",g="length",d="lastIndex",h=4294967295,b=!u(function(){RegExp(h,"y")});t("214f")("split",2,function(e,a,t,u){var y;return y="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[g]||2!="ab"[p](/(?:ab)*/)[g]||4!="."[p](/(.?)(.?)/)[g]||"."[p](/()()/)[g]>1||""[p](/.?/)[g]?function(e,a){var i=String(this);if(void 0===e&&0===a)return[];if(!n(e))return t.call(i,e,a);var l,s,r,o=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,p=void 0===a?h:a>>>0,b=new RegExp(e.source,u+"g");while(l=m.call(b,i)){if(s=b[d],s>c&&(o.push(i.slice(c,l.index)),l[g]>1&&l.index<i[g]&&f.apply(o,l.slice(1)),r=l[0][g],c=s,o[g]>=p))break;b[d]===l.index&&b[d]++}return c===i[g]?!r&&b.test("")||o.push(""):o.push(i.slice(c)),o[g]>p?o.slice(0,p):o}:"0"[p](void 0,0)[g]?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,n){var i=e(this),l=void 0==t?void 0:t[a];return void 0!==l?l.call(t,i,n):y.call(String(i),t,n)},function(e,a){var n=u(y,e,this,a,y!==t);if(n.done)return n.value;var m=i(e),f=String(this),p=l(m,RegExp),g=m.unicode,d=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(b?"y":"g"),P=new p(b?m:"^(?:"+m.source+")",d),N=void 0===a?h:a>>>0;if(0===N)return[];if(0===f.length)return null===o(P,f)?[f]:[];var D=0,A=0,T=[];while(A<f.length){P.lastIndex=b?A:0;var L,v=o(P,b?f:f.slice(A));if(null===v||(L=c(r(P.lastIndex+(b?0:A)),f.length))===D)A=s(f,A,g);else{if(T.push(f.slice(D,A)),T.length===N)return T;for(var C=1;C<=v.length-1;C++)if(T.push(v[C]),T.length===N)return T;A=D=L}}return T.push(f.slice(D)),T}]})},"36fa":function(e,a,t){"use strict";var n={url:{urlSatell:"http://39.100.62.29:6080/arcgis/rest/services/zz/ZZ_yxt/MapServer",urlPipeLine:"http://39.100.62.29:6080/arcgis/rest/services/zz/ZZ_pipe/MapServer"},CoordinateDefinition:[{DeFineName:"EPSG:4547",DefineContent:"+proj=tmerc +lat_0=0 +lon_0=114 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs",IsDeFault:!0},{DeFineName:"EPSG:4490",DefineContent:"+proj=longlat +ellps=GRS80 +no_defs",IsDeFault:!1}],MapCenter:{Center_X:113.563439,Center_Y:34.823981,Center_Zoom:3},MapExtent:{XMin:113.35975811932538,YMin:34.7501362981023,XMax:113.71391131426837,YMax:34.876861366065775,SpatialReference:4326},MapChange:{MapZoomLevel:10},Coordinates_Type:{Map_Coordinates:1},DrawAndModifyConfiguration:{source:void 0},LayerConfiguration:[{layerCName:"标识",layerName:"PipeMarkLayer",layerIndex:0,isSpatialSearch:!1,layerTableName:"PipeMark",listViewColumn:"E_PipeMark_Columns",viewIndex:1,isActive:!0,featureColumn:[{field:"equipment_number",text:"管线编号",type:"Number"},{field:"material_science",text:"材质"},{field:"caliber",text:"口径",type:"Number"},{field:"length",text:"长度",type:"Number"},{field:"startingpoint_elevation",text:"起点高程",type:"Number"},{field:"endpoint_elevation",text:"终点高程",type:"Number"},{field:"Installation_address",text:"道路名"},{field:"construction_unit",text:"施工单位"},{field:"management_unit",text:"管理单位"},{field:"completion_date",text:"竣工日期",type:"Data"},{field:"laying_age",text:"敷设年代",type:"Number"},{field:"startingpoint_depth",text:"起点埋深",type:"Number"},{field:"endpoint_depth",text:"终点埋深",type:"Number"},{field:"embedding_mode",text:"埋设方式"},{field:"Interface_form",text:"接口形式"}]},{layerCName:"管线",layerName:"PipeLineLayer",layerIndex:2,isSpatialSearch:!1,layerTableName:"Pipe",listViewColumn:"E_Pipe_Columns",viewIndex:1,isActive:!0,featureColumn:[{field:"equipment_number",text:"管线编号",type:"Number"},{field:"material_science",text:"材质"},{field:"caliber",text:"口径",type:"Number"},{field:"length",text:"长度",type:"Number"},{field:"startingpoint_elevation",text:"起点高程",type:"Number"},{field:"endpoint_elevation",text:"终点高程",type:"Number"},{field:"Installation_address",text:"道路名"},{field:"construction_unit",text:"施工单位"},{field:"management_unit",text:"管理单位"},{field:"completion_date",text:"竣工日期",type:"Data"},{field:"laying_age",text:"敷设年代",type:"Number"},{field:"startingpoint_depth",text:"起点埋深",type:"Number"},{field:"endpoint_depth",text:"终点埋深",type:"Number"},{field:"embedding_mode",text:"埋设方式"},{field:"Interface_form",text:"接口形式"}]},{layerCName:"点位",layerName:"ExhaustvalveLayer",layerIndex:1,isSpatialSearch:!0,layerTableName:"Exhaustvalve",listViewColumn:"E_Exhaustvalve_Columns",isActive:!0,viewIndex:2,featureColumn:[{field:"equipment_number",text:"编号",type:"Number"},{field:"material_science",text:"材质"},{field:"caliber",text:"口径",type:"Number"},{field:"elevation",text:"高程",type:"Number"},{field:"depth",text:"埋深",type:"Number"},{field:"Installation_address",text:"安装地址"},{field:"management_unit",text:"管理单位"},{field:"completion_date",text:"竣工日期",type:"Data"},{field:"laying_age",text:"敷设年代",type:"Number"},{field:"embedding_mode",text:"埋设方式"},{field:"equipment_type",text:"设备类型"},{field:"coordinate_x",text:"横坐标",type:"Number"},{field:"coordinate_y",text:"纵坐标",type:"Number"},{field:"Interface_form",text:"接口形式"},{field:"specifications",text:"规格"},{field:"manufacturer",text:"生产厂家"},{field:"businessarea",text:"营业片区"}]}]};a["a"]=n},"649e":function(e,a,t){"use strict";t("c5f6");var n=t("d255");a["a"]={PlanTypeLoad:function(){return n["a"].get("/PlanType/GetCommboboxList")},PlanTypeSearch:function(e,a,t,i,l){return i=i||"PlanTypeId",l=l||"asc",n["a"].get("/PlanType/Get",{params:{planTypeId:Number(t),sort:String(i),ordering:String(l),num:Number(e),page:Number(a)}})},PlanTypeAdd:function(e,a){return n["a"].post("/PlanType/Post",{PlanTypeName:String(e),ParentTypeId:Number(a)})},PlanTypeEdit:function(e,a,t){return n["a"].put("/PlanType/Put?PlanTypeId="+Number(t),{PlanTypeName:String(e),ParentTypeId:Number(a)})},PlanTypeDel:function(e){return n["a"].delete("/PlanType/Delete",{params:{planTypeId:Number(e)}})}}},"68cf":function(e,a,t){"use strict";t("c5f6");var n=t("d255");a["a"]={GetPlanLine:function(e,a,t,i){return i=i||"PlanLineId",t=t||"desc",e=e||15,a=a||1,n["a"].get("/PlanLine/Get",{params:{sort:String(i),ordering:String(t),num:Number(e),page:Number(a)}})},AddPlanLine:function(e,a,t){return n["a"].post("/PlanLine/Post",{PlanLineName:String(e),GeoText:String(a),PatroGeoText:String(t)})},EditPlanLine:function(e,a,t,i){return n["a"].put("/PlanLine/Put?planLineId="+e,{PlanLineName:String(a),GeoText:String(t),PatroGeoText:String(i)})},DeletePlanLine:function(e){return n["a"].delete("/PlanLine/Delete",{params:{planLineId:Number(e)}})}}},a060:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"table_style formItem",class:{flexible:e.flexible}},[t("TableFormTitle",{attrs:{titleName:"巡检计划管理",flexible:e.flexible},on:{"update:flexible":function(a){e.flexible=a}}}),t("el-form",{attrs:{"label-width":"48px"}},[t("el-row",[t("el-col",{attrs:{span:7,xs:12,sm:12,lg:7}},[t("el-form-item",{attrs:{label:"名称："}},[t("el-input",{attrs:{size:"mini"},model:{value:e.serachCondition,callback:function(a){e.serachCondition=a},expression:"serachCondition"}})],1)],1),t("el-col",{attrs:{span:8,xs:13,sm:13,lg:{span:8,offset:1}}},[t("el-form-item",{attrs:{label:"类型："}},[t("el-row",{staticStyle:{padding:"0"},attrs:{type:"flex",justify:"start"}},e._l(e.attrList,function(a){return t("el-radio",{key:a.value,staticClass:"my-radio",attrs:{size:"mini",label:a.value},on:{change:function(t){e.attrChange(a)}},model:{value:e.isNomalPlan,callback:function(a){e.isNomalPlan=a},expression:"isNomalPlan"}},[e._v(e._s(a.text))])}),1)],1)],1)],1),t("el-row",{attrs:{type:"flex",justify:"end"}},[e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/GetPlanManageInfo",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-search",attrs:{size:"mini"},on:{click:e.searchBtn}},[e._v("查询")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/GetPlanManageInfo",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-reset",attrs:{size:"mini"},on:{click:e.resetBtn}},[e._v("重置")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/GetPlanManageInfo",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-regionIns",attrs:{type:"",size:"mini"},on:{click:function(a){e.GetPlanType(1)}}},[e._v("区域巡检")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/GetPlanManageInfo",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-routeIns",attrs:{type:"",size:"mini"},on:{click:function(a){e.GetPlanType(2)}}},[e._v("路线巡检")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/GetPlanManageInfo",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-all",attrs:{size:"mini"},on:{click:function(a){e.GetPlanType(0)}}},[e._v("全部")]):e._e()],1),t("el-row",{staticClass:"table-btn-control",attrs:{type:"flex",justify:"start"}},[e.$options.filters.btnTree("/api//InspectionPlan/PlanManage/Post",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-tableout",attrs:{plain:"",size:"mini"},on:{click:e.addItem}},[t("i",{staticClass:"iconfont icon-xinzeng"}),e._v("新增\n      ")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/Put",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-tableout",attrs:{size:"mini"},on:{click:e.editItem}},[t("i",{staticClass:"iconfont icon-bianji"}),e._v("编辑\n      ")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/Delete",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-tableout",attrs:{size:"mini"},on:{click:e.delItem}},[t("i",{staticClass:"iconfont icon-shanchu"}),e._v("删除\n      ")]):e._e(),e.$options.filters.btnTree("/api/InspectionPlan/PlanManage/AssignTask",e.$route.meta.iFunID)?t("el-button",{staticClass:"my-tableout",attrs:{size:"mini"},on:{click:e.PlanAssign}},[t("i",{staticClass:"iconfont icon-jihuafenpai"}),e._v(" 计划分派\n      ")]):e._e()],1)],1),t("InsTable",{attrs:{layerListName:"Ins_PlanManage_Columns",tableHeight:"calc(100vh - 273px)",columnListData:e.squareQueryRawTableData,loading:e.loading,pageSize:e.currentPageSize,pageNumber:e.currentPageNumber,dataTotal:e.squareQueryTotal,layeName:"InsPlan",tableIndex:e.tableIndex},on:{"update:loading":function(a){e.loading=a},"update:pageSize":function(a){e.currentPageSize=a},"update:pageNumber":function(a){e.currentPageNumber=a},"update:tableIndex":function(a){e.tableIndex=a},tableDbClick:e.tableDbClick,GetData:e.GetData,currentChange:e.currentChange,deltableItem:e.deltableItem}}),t("el-dialog",{staticClass:"myDialog",attrs:{title:"计划分派",visible:e.assignDialogVisible,"before-close":e.handleClose,customClass:"el_add_dialog"},on:{"update:visible":function(a){e.assignDialogVisible=a}}},[t("el-form",{attrs:{"label-width":"80px",size:"small"}},[t("el-form-item",{attrs:{label:"计划名称："}},[t("el-input",{attrs:{disabled:""},model:{value:e.alignNameChangeValue,callback:function(a){e.alignNameChangeValue=a},expression:"alignNameChangeValue"}})],1),t("el-form-item",{attrs:{label:"任务名称："}},[t("el-input",{model:{value:e.alignNameChangeTime,callback:function(a){e.alignNameChangeTime=a},expression:"alignNameChangeTime"}})],1),t("el-form-item",{attrs:{label:"部门："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.deptDataChange},model:{value:e.fromAssignDept,callback:function(a){e.fromAssignDept=a},expression:"fromAssignDept"}},e._l(e.deptData,function(e){return t("el-option",{key:e.iDeptID,attrs:{label:e.cDepName,value:e.cDepName}})}),1)],1),t("el-form-item",{attrs:{label:"分派人员："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.fromAssignStaff,callback:function(a){e.fromAssignStaff=a},expression:"fromAssignStaff"}},e._l(e.staffData,function(e){return t("el-option",{key:e.iAdminID,attrs:{label:e.cAdminName,value:e.cAdminName}})}),1)],1),t("el-form-item",{attrs:{label:"开始时间："}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date"},on:{change:e.onChangeStarTime},model:{value:e.fromAssignPlan.starTime,callback:function(a){e.$set(e.fromAssignPlan,"starTime",a)},expression:"fromAssignPlan.starTime"}})],1),t("el-form-item",{attrs:{label:"结束时间："}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date"},model:{value:e.fromAssignPlan.endTime,callback:function(a){e.$set(e.fromAssignPlan,"endTime",a)},expression:"fromAssignPlan.endTime"}})],1),t("el-form-item",{attrs:{label:"任务描述："}},[t("el-input",{model:{value:e.fromAssignPlan.descript,callback:function(a){e.$set(e.fromAssignPlan,"descript",a)},expression:"fromAssignPlan.descript"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"my-dialog-cancel",on:{click:function(a){e.assignDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{staticClass:"my-dialog-submit",on:{click:e.submitPlanAssign}},[e._v("提 交")])],1)],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"myDialog insPlanDialog",attrs:{title:"新增计划",modal:!1,center:"",visible:e.dialogVisible,"before-close":e.handleClose,customClass:"el_add_dialog"},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("el-form",{attrs:{"label-width":"100px",size:"small"}},[t("el-form-item",{attrs:{label:"计划名称："}},[t("el-input",{on:{change:e.alignNameChange},model:{value:e.alignNameChangeValue,callback:function(a){e.alignNameChangeValue=a},expression:"alignNameChangeValue"}})],1),t("el-form-item",{attrs:{label:"巡检类型："}},[t("el-select",{attrs:{placeholder:"请选择",disabled:e.isEditPattern},on:{change:e.ChangePatrolType},model:{value:e.formLabelAlign.patrolType,callback:function(a){e.$set(e.formLabelAlign,"patrolType",a)},expression:"formLabelAlign.patrolType"}},e._l(e.patrolTypeData,function(e){return t("el-option",{key:e.PlanTypeId,attrs:{label:e.PlanTypeName,value:e.PlanTypeName}})}),1)],1),t("el-form-item",{attrs:{label:"计划类型："}},[t("el-select",{attrs:{placeholder:"请选择",disabled:e.isEditPattern},model:{value:e.formLabelAlign.planType,callback:function(a){e.$set(e.formLabelAlign,"planType",a)},expression:"formLabelAlign.planType"}},e._l(e.planTypeData,function(e){return t("el-option",{key:e.PlanTypeId,attrs:{label:e.PlanTypeName,value:e.PlanTypeId}})}),1)],1),t("el-form-item",{attrs:{label:"区域巡检"==e.formLabelAlign.patrolType?"区域名称：":"路线名称："}},[t("el-select",{attrs:{placeholder:"请选择",disabled:e.isEditPattern},on:{change:e.onChangeAreaName},model:{value:e.formLabelAlign.areaName,callback:function(a){e.$set(e.formLabelAlign,"areaName",a)},expression:"formLabelAlign.areaName"}},e._l(e.areaNameData,function(a,n){return t("el-option",{key:n,attrs:{label:"区域巡检"==e.formLabelAlign.patrolType?a.PlanAreaName:a.PlanLineName,value:"区域巡检"==e.formLabelAlign.patrolType?a.PlanAreaId:a.PlanLineId}})}),1)],1),"区域巡检"==e.formLabelAlign.patrolType?t("el-form-item",{attrs:{label:"设备实体："}},[t("el-select",{attrs:{multiple:"",placeholder:"请选择",disabled:e.isEditPattern},on:{change:e.onChangeFacility},model:{value:e.watchFacilityNew,callback:function(a){e.watchFacilityNew=a},expression:"watchFacilityNew"}},e._l(e.facilityData,function(e,a){return t("el-option",{key:a,attrs:{label:e.layerCName,value:a}})}),1)],1):e._e(),"区域巡检"==e.formLabelAlign.patrolType?t("el-form-item",{attrs:{label:"辅助路径："}},[t("el-input",{attrs:{disabled:"",placeholder:"请在地图上选择辅助路线"},model:{value:e.formLabelAlign.route,callback:function(a){e.$set(e.formLabelAlign,"route",a)},expression:"formLabelAlign.route"}})],1):e._e(),t("el-form-item",{attrs:{label:"是否需要反馈："}},[t("el-radio",{attrs:{label:"1",disabled:e.isEditPattern},model:{value:e.formLabelAlign.isFeedback,callback:function(a){e.$set(e.formLabelAlign,"isFeedback",a)},expression:"formLabelAlign.isFeedback"}},[e._v("需反馈")]),t("el-radio",{attrs:{label:"0",disabled:e.isEditPattern},model:{value:e.formLabelAlign.isFeedback,callback:function(a){e.$set(e.formLabelAlign,"isFeedback",a)},expression:"formLabelAlign.isFeedback"}},[e._v("仅到位")])],1),t("el-form-item",{attrs:{label:"计划类型："}},[t("el-radio",{attrs:{label:"1"},model:{value:e.formLabelAlign.planTypeslect,callback:function(a){e.$set(e.formLabelAlign,"planTypeslect",a)},expression:"formLabelAlign.planTypeslect"}},[e._v("常规")]),t("el-radio",{attrs:{label:"0"},model:{value:e.formLabelAlign.planTypeslect,callback:function(a){e.$set(e.formLabelAlign,"planTypeslect",a)},expression:"formLabelAlign.planTypeslect"}},[e._v("临时")])],1),t("el-form-item",{attrs:{label:"巡检方式："}},[t("el-radio",{attrs:{label:"1"},model:{value:e.formLabelAlign.patrolWay,callback:function(a){e.$set(e.formLabelAlign,"patrolWay",a)},expression:"formLabelAlign.patrolWay"}},[e._v("车巡")]),t("el-radio",{attrs:{label:"2"},model:{value:e.formLabelAlign.patrolWay,callback:function(a){e.$set(e.formLabelAlign,"patrolWay",a)},expression:"formLabelAlign.patrolWay"}},[e._v("步行")])],1),t("el-form-item",{attrs:{label:"计划周期："}},[t("el-select",{attrs:{placeholder:"请选择",disabled:e.isEditPattern},model:{value:e.formLabelAlign.planCycle,callback:function(a){e.$set(e.formLabelAlign,"planCycle",a)},expression:"formLabelAlign.planCycle"}},e._l(e.planCycleData,function(e){return t("el-option",{key:e.PlanCycleId,attrs:{label:e.PlanCycleName,value:e.PlanCycleId}})}),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"my-dialog-cancel",on:{click:function(a){e.dialogVisible=!1}}},[e._v("取 消")]),e.isEditPattern?e._e():t("el-button",{staticClass:"my-dialog-submit",on:{click:e.SubmitPlanData}},[e._v("确 定")]),e.isEditPattern?t("el-button",{staticClass:"my-dialog-submit",on:{click:e.EditPlanManage}},[e._v("修 改")]):e._e()],1)],1)],1)},i=[],l=(t("c5f6"),t("28a5"),t("f499")),s=t.n(l),r=(t("6b54"),t("ac6a"),t("2ef0")),o=t.n(r),m=(t("5e4b"),t("36fa")),u=t("1b9e"),c=t("c7fc"),f=t("f44c"),p=t("d255"),g={GetPlanManage:function(e,a,t,n,i,l,s){e=e||15,a=a||1,s=s||"desc",l=l||"PlanId",i=i||"";var r={serachCondition:String(i),sort:String(l),ordering:String(s),page:Number(a),num:Number(e)};return null!=n&&(r["isNomalPlan"]=Number(n)),null!=t&&(r["planTypeId"]=Number(t)),p["a"].get("/InspectionPlan/PlanManage/GetPlanManageInfo",{params:r})},AddPlanManage:function(e,a,t,n,i,l,s,r,o,m,u,c,f,g){return Object(p["a"])({method:"post",url:"/InspectionPlan/PlanManage/Post",params:{planName:String(e),planTypeId:Number(a),planTypeLB:Number(t),planCycleId:Number(n),isFeedBack:Number(i),isNomalPlan:Number(l),moveType:Number(s),equipmentIdList:String(r),equipmentNameList:String(o),invalidationDate:m,planAreaId:Number(u),planLineId:Number(c),planPath:String(f)},data:{equmentInfo:String(g)}})},EditPlanManage:function(e,a,t,n){return Object(p["a"])({method:"put",url:"/InspectionPlan/PlanManage/Put",params:{PlanId:Number(e),planName:String(a),isNomalPlan:Number(t),moveType:Number(n)}})},DeletePlanManage:function(e){return p["a"].delete("/InspectionPlan/PlanManage/Delete",{params:{PlanId:Number(e)}})},AddPlanManageAssign:function(e,a,t,n,i,l,s,r,o,m){return Object(p["a"])({method:"post",url:"/InspectionPlan/PlanManage/AssignTask",params:{taskName:String(e),proraterDeptName:String(a),proraterDeptId:Number(t),proraterName:String(n),proraterId:Number(i),starTime:String(l),endTime:String(s),descript:String(r),planId:Number(o),planName:String(m)}})}},d=t("1520"),h=t("649e"),b=t("aa97"),y=t("68cf"),P=t("1d1f"),N=t("2368"),D={components:{TableFormTitle:P["a"],InsTable:N["a"]},data:function(){return{loading:!0,columnListData:[],dataTotal:1,currentPageNumber:1,currentPageSize:50,currentRow:null,flexible:!1,tableIndex:[],attrList:[{text:"全部",value:null},{text:"常规",value:"1"},{text:"临时",value:"0"}],planCycleData:[],patrolTypeData:[],planTypeData:[],areaNameData:[],routeNameData:[],facilityData:[],watchFacilityNew:[],watchFacilityOld:[],watchFacilityGeometry:[],formLabelAlign:{patrolType:"",planType:"",areaName:"",routeName:"",facilityNum:[],facility:[],route:"",isFeedback:"1",planTypeslect:"1",patrolWay:"1",planCycle:""},assignDialogVisible:!1,dialogVisible:!1,isEditPattern:!1,serachCondition:null,planTypeId:null,isNomalPlan:null,alignNameChangeValue:"",alignNameChangeTime:"",deptData:[],staffData:[],fromAssignDept:"",fromAssignStaff:"",fromAssignPlan:{deptId:0,starTime:new Date,endTime:"",descript:""},FeatureData:void 0}},watch:{watchFacilityNew:function(e,a){var t=this;this.watchFacilityOld=a,this.formLabelAlign.facility=[],this.formLabelAlign.facilityNum=[];var n=o.a.intersection(e,a),i=[];e.length>a.length&&(console.log(" //设备添加实体选择模板"),i=o.a.difference(e,n)[0],this.formLabelAlign.facility.push(this.facilityData[i].layerName),this.formLabelAlign.facilityNum.push(this.facilityData[i].layerIndex),this.$bus.emit("setSpatialSearchOnMap",!0,this.formLabelAlign.facilityNum,this.formLabelAlign.facility,this.FeatureData,function(e,a){console.log("添加",e,a),t.watchFacilityGeometry.push({layerIndex:e[0],PointValue:a}),console.log(t.watchFacilityGeometry)})),e.length<a.length&&a.length>0&&(i=o.a.difference(a,n)[0],this.formLabelAlign.facility.push(this.facilityData[i].layerName),this.formLabelAlign.facilityNum.push(this.facilityData[i].layerIndex),this.$bus.emit("setSpatialSearchOnMap",!1,this.formLabelAlign.facilityNum,this.formLabelAlign.facility,this.FeatureData,function(e,a){console.log("删除",e,a)}))}},beforeMount:function(){this.GetEquipment()},beforeDestroy:function(){this.$bus.emit("setBusinessLayerGroupVisible",!1),this.$bus.emit("setVectorLayerVisible",!0)},mounted:function(){this.onLoadData(),this.GetData(1),this.DeptData()},computed:{formLabelAlignName:function(){return this.formLabelAlign.areaName+"_"+this.formLabelAlign.patrolType},fromAssignStaffId:function(){var e=this;return o.a.filter(this.staffData,function(a){return a.cAdminName==e.fromAssignStaff})[0].iAdminID}},methods:{currentChange:function(e){this.currentRow=e},searchBtn:function(){this.GetData(1)},PlanAssign:function(){this.currentRow?(this.assignDialogVisible=!0,this.alignNameChangeValue=this.currentRow.PlanName,this.alignNameChangeTime=(new Date).getMonth()+1+"月_"+this.currentRow.PlanName,this.DeptData(),this.AdminNameData(19),this.getMonthLastDay()):this.$message({type:"warning",message:"请选择要编辑的行",showClose:!0})},submitPlanAssign:function(){var e=this;g.AddPlanManageAssign(this.alignNameChangeTime,this.fromAssignDept,this.fromAssignPlan.deptId,this.fromAssignStaff,this.fromAssignStaffId,this.fromAssignPlan.starTime,this.fromAssignPlan.endTime,this.fromAssignPlan.descript,this.currentRow.PlanId,this.currentRow.PlanName).then(function(a){e.assignDialogVisible=!1,e.$message({type:"success",message:"分派成功",showClose:!0})})},onChangeAreaName:function(e){var a=this;if(this.watchFacilityNew=[],this.alignNameChangeValue=this.formLabelAlignName,"区域巡检"==this.formLabelAlign.patrolType){var t=o.a.filter(this.areaNameData,function(a){return a.PlanAreaId==e}),n=[JSON.parse(t[0].GeoText)];this.$bus.emit("setPolygonOnMap",n,[t[0].PlanAreaName],!1,function(e){console.log(e),a.FeatureData=e}),Object(u["c"])(t[0].GeoText,function(e){a.$bus.emit("setCenter",e)})}else{var i=o.a.filter(this.areaNameData,function(a){return a.PlanLineId==e})[0],l=JSON.parse(i.GeoText),s=i.PlanLineName,r=JSON.parse(i.PatroGeoText);this.$bus.emit("setLineStringOnMap",[l],[s],!1,function(e,a){console.log("change地图路线")},[r]),Object(u["c"])(i.GeoText,function(e){a.$bus.emit("setCenter",e)})}},onChangeStarTime:function(e){console.log(e)},deptDataChange:function(e){this.fromAssignPlan.deptId=o.a.filter(this.deptData,function(a){return a.cDepName==e})[0].iDeptID,this.AdminNameData(this.fromAssignPlan.deptId)},DeptData:function(){var e=this;d["a"].DeptData().then(function(a){e.deptData=a.data.Data.Result,e.fromAssignDept=e.deptData[0].cDepName,e.fromAssignPlan.deptId=o.a.filter(e.deptData,function(a){return a.cDepName==e.fromAssignDept})[0].iDeptID,e.AdminNameData(e.fromAssignPlan.deptId)})},AdminNameData:function(e){var a=this;d["a"].GetUserComboboxListNoDelete(e).then(function(e){a.staffData=e.data.Data.Result,console.log("this.staffData",a.staffData),a.staffData.length>0?a.fromAssignStaff=a.staffData[0].cAdminName:(a.fromAssignStaff="无",a.fromAssignStaffId=0)})},onLoadData:function(){this.isNomalPlan=this.attrList[0].value},onChangeFacility:function(e){this.watchFacilityNew=e},GetPlanType:function(e){0==e&&(e=null),this.planTypeId=e,this.GetData(1)},attrChange:function(e){this.isNomalPlan=e.value},GetData:function(e,a){var t=this;this.loading=!0,"number"==typeof e&&(this.currentPageNumber=e),"number"==typeof a&&(this.currentPageSize=a),g.GetPlanManage(this.currentPageSize,this.currentPageNumber,this.planTypeId,this.isNomalPlan,this.serachCondition).then(function(e){t.loading=!1,t.squareQueryRawTableData=e.data.Data.Result,console.log(e.data.Data.Result),o.a.forEach(t.squareQueryRawTableData,function(e){e.PlanAreaName||(e.PlanAreaName=e.PlanLineName)}),t.squareQueryTotal=e.data.Data.TotalRows})},resetBtn:function(){this.attrChange({text:"全部",value:null}),this.serachCondition="",this.planTypeId=null,this.GetPlanType(0)},ChangePatrolType:function(e){this.$bus.emit("setBusinessLayerGroupVisible",!1),"区域巡检"==this.formLabelAlign.patrolType?(this.$bus.emit("setBusinessLayerGroupVisible",!0),this.AddPlanData(1)):(this.$bus.emit("setBusinessLayerGroupVisible",!0),this.AddPlanData(2))},AddPlanData:function(e){this.GetPlanTypeRoute(e),this.GetPlanTypeClass(e),this.GetPlanCycle(),1==e?this.GetRegionalData():this.GetPlanLine()},addItem:function(){this.$bus.emit("setBusinessLayerGroupVisible",!1),this.$bus.emit("setSpatialSearchLayerGroupDisplay",!0,!0),this.isEditPattern=!1,this.dialogVisible=!0,this.watchFacilityNew=[],this.formLabelAlign.planType="",this.formLabelAlign.planCycle="",this.dialogTitle="新增",this.AddPlanData(1)},SubmitPlanData:function(){var e=this;this.formLabelAlign.facility=[],this.formLabelAlign.facilityNum=[];for(var a=0;a<this.watchFacilityNew.length;a++)this.formLabelAlign.facility.push(this.facilityData[this.watchFacilityNew[a]].layerCName),this.formLabelAlign.facilityNum.push(this.facilityData[this.watchFacilityNew[a]].layerIndex);console.log(this.formLabelAlign.facility),console.log(this.formLabelAlign.facilityNum);var t=new Date,n="",i="";n=this.formLabelAlign.facility.length>0?this.formLabelAlign.facility.toString():"未填写",i=this.formLabelAlign.facilityNum.length>0?this.formLabelAlign.facilityNum.toString():"1111";var l=0;l="区域巡检"==this.formLabelAlign.patrolType?1:2;var r="",m="";if(console.log(this.formLabelAlign.areaName),1==l?r=this.formLabelAlign.areaName:m=this.formLabelAlign.areaName,""!=this.formLabelAlign.planType)if(""!=this.formLabelAlign.planCycle){var u=[];o.a.map(this.watchFacilityGeometry,function(e){u.push(e.PointValue)}),console.log("watchFacilityGeometryAdd.length",u.length),u=u[0],u=s()(u),console.log(this.alignNameChangeValue),g.AddPlanManage(this.alignNameChangeValue,l,this.formLabelAlign.planType,this.formLabelAlign.planCycle,this.formLabelAlign.isFeedback,this.formLabelAlign.planTypeslect,this.formLabelAlign.patrolWay,i,n,t,r,m,"ddddd",u).then(function(a){e.dialogVisible=!1,e.GetData(1),e.$message({type:"success",message:"新增成功",showClose:!0}),e.watchFacilityNew=[],e.watchFacilityGeometry=[]})}else this.$message({type:"warning",message:"请选择计划周期",showClose:!0});else this.$message({type:"warning",message:"请选择计划类型",showClose:!0})},editItem:function(){if(this.tableDbClick(this.currentRow),console.log(this.currentRow),this.currentRow)this.dialogVisible=!0,this.dialogTitle="编辑",this.dialogData=this.currentRow,this.alignNameChangeValue=this.currentRow.PlanName,this.formLabelAlign.patrolType=this.currentRow.PlanTypeName,this.currentRow.PlanAreaName?this.formLabelAlign.areaName=this.currentRow.PlanAreaName:this.formLabelAlign.areaName=this.currentRow.PlanLineName,this.formLabelAlign.planType=this.currentRow.PlanTypeNameLB,this.formLabelAlign.planCycle=this.currentRow.PlanCycleName,this.formLabelAlign.isFeedback="需反馈"==this.currentRow.BoolFeedBack?"1":"0",this.formLabelAlign.planTypeslect="常规"==this.currentRow.BoolNormalPlan?"1":"0",this.formLabelAlign.patrolWay="车巡"==this.currentRow.MoveType?"1":"2",this.isEditPattern=!0,this.watchFacilityNew=this.currentRow.EquipmentName.split(",");else{if(!this.tableIndex.length||this.tableIndex.length>1)return void this.$message({type:"warning",message:"请选择要编辑的数据",showClose:!0});this.dialogVisible=!0,this.dialogTitle="编辑"}},EditPlanManage:function(){var e=this;g.EditPlanManage(this.currentRow.PlanId,this.alignNameChangeValue,this.formLabelAlign.planTypeslect,this.formLabelAlign.patrolWay).then(function(a){e.dialogVisible=!1,e.$message({type:"success",message:"编辑成功",showClose:!0}),e.GetData(1)})},delItem:function(){var e=this;if(this.tableIndex.length||this.currentRow){var a=o.a.map(this.tableIndex,function(e){return e.PlanId});console.log(a),this.tableIndex.length?this.$confirm("确认删除多选数据？").then(function(){g.DeletePlanManage(a.join(",")).then(function(a){e.GetData(1),e.$message({type:"success",message:"删除成功",showClose:!0})})}).catch(function(e){}):this.$confirm("确认删除？").then(function(){g.DeletePlanManage(e.currentRow.PlanId).then(function(a){e.$message({type:"success",message:"删除成功",showClose:!0}),e.GetData(1)})}).catch(function(e){})}else this.$message({type:"warning",message:"请选择要删除的数据",showClose:!0})},GetPlanTypeRoute:function(e){var a=this;this.patrolTypeData.length<1&&h["a"].PlanTypeLoad().then(function(t){a.patrolTypeData=t.data.Data.Result,a.formLabelAlign.patrolType=a.patrolTypeData[e-1].PlanTypeName,a.alignNameChangeValue=a.formLabelAlignName})},GetPlanTypeClass:function(e){var a=this;this.planTypeData.length<1&&h["a"].PlanTypeSearch(20,1,e).then(function(e){a.planTypeData=e.data.Data.Result})},GetRegionalData:function(){var e=this;this.areaNameData.length<1?b["a"].RegionalData().then(function(a){e.areaNameData=a.data.Data.Result,e.RegionalDataPosition()}):this.RegionalDataPosition()},RegionalDataPosition:function(){var e=this;this.formLabelAlign.areaName=this.areaNameData[0].PlanAreaId,this.alignNameChangeValue=this.formLabelAlignName,this.$bus.emit("setBusinessLayerGroupVisible",!0);var a=JSON.parse(this.areaNameData[0].GeoText),t=this.areaNameData[0].PlanAreaName;this.$bus.emit("setPolygonOnMap",[a],[t],!1,function(a){e.FeatureData=a}),Object(u["c"])(this.areaNameData[0].GeoText,function(a){e.$bus.emit("setCenter",a)})},GetPlanLine:function(){var e=this;this.areaNameData.length<1&&y["a"].GetPlanLine().then(function(a){console.log(a.data.Data.Result),e.$bus.emit("setBusinessLayerGroupVisible",!0),e.areaNameData=a.data.Data.Result,console.log("//获取路线名称",a.data.Data.Result),e.formLabelAlign.areaName=e.areaNameData[0],e.formLabelAlign.areaName=a.data.Data.Result[0].PlanLineId,e.alignNameChangeValue=e.formLabelAlignName;var t=JSON.parse(a.data.Data.Result[0].GeoText),n=a.data.Data.Result[0].PlanLineName,i=JSON.parse(a.data.Data.Result[0].PatroGeoText);e.$bus.emit("setLineStringOnMap",[t],[n],!1,function(e,a){console.log(e)},[i]),Object(u["c"])(a.data.Data.Result[0].GeoText,function(a){e.$bus.emit("setCenter",a)})})},getMonthLastDay:function(){var e=new Date,a=new Date(e);console.log(a),a.setMonth(a.getMonth()+1),a.setDate("1"),a.setDate(a.getDate()-1),this.fromAssignPlan.endTime=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+a.getDate(),this.fromAssignPlan.starTime=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},GetEquipment:function(){var e=this;o.a.map(m["a"].LayerConfiguration,function(a){a.isSpatialSearch&&e.facilityData.push(a)})},GetPlanCycle:function(){var e=this;this.planCycleData.length<1&&d["a"].GetPlanCycle().then(function(a){e.planCycleData=a.data.Data.Result})},tableDbClick:function(e){if(this.$bus.emit("removeInteractions"),this.$bus.emit("setVectorLayerVisible",!1),this.$bus.emit("setTempLayerGroupVisible",!1),this.$bus.emit("setBusinessLayerGroupVisible",!1),this.$bus.emit("setSpatialSearchLayerGroupDisplay",!0,!0),null!=e.GeoText){try{JSON.parse(e.GeoText)}catch(t){return void this.$message({type:"error",message:"您选择的区域已删除,请联系管理员!",showClose:!0})}var a=JSON.parse(e.GeoText);this.$bus.emit("setBusinessLayerGroupVisible",!0),"区域巡检"==e.PlanTypeName&&this.areaTableDbClick(e,a),"路线巡检"==e.PlanTypeName&&this.routeTableDbClick(e,a)}else this.$message({type:"error",message:"您选择的区域已删除,请联系管理员!",showClose:!0})},areaTableDbClick:function(e,a){var t=this,n=e.PlanAreaName;this.$bus.emit("setPolygonOnMap",[a],[n],!1,function(a){t.mapSearch(a,e)}),f["a"].GetPointArea(20,1,e.PlanAreaId).then(function(e){var a=[],n=[];o.a.map(e.data.Data.Result,function(e){a.push([Number(e.PointX),Number(e.PointY)]),n.push({PointName:e.PointName})}),t.$bus.emit("onPointermoveControl"),t.$bus.emit("setPointOnMap",a,!1,function(e,a){},"RegionalPoint",n)}),Object(u["c"])(e.GeoText,function(e){t.$bus.emit("setCenter",e)})},routeTableDbClick:function(e,a){var t=this,n=JSON.parse(e.PatroGeoText),i=e.PlanLineName;this.$bus.emit("setLineStringOnMap",[a],[i],!1,function(e){console.log("地图上显示路线")},[n]),c["a"].GetPlanLineDetail(20,1,e.PlanLineId).then(function(e){var a=[],n=[];o.a.forEach(e.data.Data.Result,function(e){a.push([Number(e.X),Number(e.Y)]),n.push({ImportPointName:e.ImportPointName,AddTime:e.AddTime})}),t.$bus.emit("onPointermoveControl"),t.$bus.emit("setPointOnMap",a,!1,function(){},"RoutePoint",n)}),Object(u["c"])(e.GeoText,function(e){t.$bus.emit("setCenter",e)})},mapSearch:function(e,a){for(var t=this,n=a.EquipmentList.split(","),i=[],l=function(e){o.a.map(t.facilityData,function(a){a.layerIndex==Number(n[e])&&i.push(a.layerName)})},s=0;s<n.length;s++)l(s);for(s=0;s<n.length;s++)this.$bus.emit("setSpatialSearchOnMap",!0,Number(n[s]),i[s],e)}}},A=D,T=t("2877"),L=Object(T["a"])(A,n,i,!1,null,null,null);L.options.__file="PlanManage.vue";var v=L.exports;a["default"]=v},aa97:function(e,a,t){"use strict";t("c5f6");var n=t("d255");a["a"]={RegionalData:function(e,a,t,i){return e=e||50,a=a||1,t=t||"OperateAddTime",i=i||"desc",n["a"].get("/PlanArea/Get",{params:{num:Number(e),page:Number(a),sort:String(t),ordering:String(i)}})},AddPlanArea:function(e,a,t,i){return n["a"].post("/PlanArea/Post",{PlanAreaName:String(e),GeoText:String(a),DeptId:Number(t),PersonId:Number(i)})},EditPlanArea:function(e,a,t,i,l){return n["a"].put("/PlanArea/Put?PointId="+e,{PlanAreaId:Number(e),PlanAreaName:String(a),GeoText:String(t),DeptId:Number(i),PersonId:Number(l)})},DeletePlanArea:function(e){return n["a"].delete("/PlanArea/Delete",{params:{PointId:Number(e)}})}}}}]);
//# sourceMappingURL=chunk-124bf5a4.06e5dd40.js.map